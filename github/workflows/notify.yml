name: Notify on Changes

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  notify:
    runs-on: ubuntu-latest
    
    steps:
    - name: Send Telegram notification
      uses: appleboy/telegram-action@master
      with:
        to: ${{ secrets.TELEGRAM_CHAT_ID }}
        token: ${{ secrets.TELEGRAM_TOKEN }}
        message: |
          ğŸ”” ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©
          
          ğŸ“Œ Ø§Ù„ÙØ±Ø¹: ${{ github.ref }}
          ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${{ github.actor }}
          ğŸ“ Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ${{ github.event.commits[0].message }}
          ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø·: ${{ github.event.commits[0].url }}
          
          ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ…
          
    - name: Send email notification
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 465
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}
        subject: 'ØªØ­Ø¯ÙŠØ« Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©'
        to: ${{ secrets.EMAIL_TO }}
        from: GitHub Actions
        html_body: |
          <!DOCTYPE html>
          <html dir="rtl">
          <head>
              <meta charset="UTF-8">
              <style>
                  body { font-family: Arial, sans-serif; }
                  .container { max-width: 600px; margin: 0 auto; }
                  .header { background: #000; color: #0f0; padding: 20px; text-align: center; }
                  .content { padding: 20px; background: #f5f5f5; }
              </style>
          </head>
          <body>
              <div class="container">
                  <div class="header">
                      <h1>âš¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© âš¡</h1>
                  </div>
                  <div class="content">
                      <h2>ğŸ”” ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯</h2>
                      <p><strong>Ø§Ù„ÙØ±Ø¹:</strong> ${{ github.ref }}</p>
                      <p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${{ github.actor }}</p>
                      <p><strong>Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</strong> ${{ github.event.commits[0].message }}</p>
                      <p><strong>Ø§Ù„Ø±Ø§Ø¨Ø·:</strong> <a href="${{ github.event.commits[0].url }}">Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ø¯ÙŠØ«</a></p>
                      <hr>
                      <p>ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ…</p>
                  </div>
              </div>
          </body>
          </html>
