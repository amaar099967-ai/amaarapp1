name: Arabic Language Check

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  arabic-check:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check Arabic text
      run: |
        echo "ðŸ” ÙØ­Øµ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©..."
        
        # ÙØ­Øµ HTML files
        if [ -f "index.html" ]; then
          echo "ÙØ­Øµ index.html..."
          ARABIC_COUNT=$(grep -o -P '[\x{0600}-\x{06FF}]' index.html | wc -l)
          echo "âœ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙÙŠ index.html: $ARABIC_COUNT"
          
          # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ù„ØºØ©
          if ! grep -q 'lang="ar"' index.html; then
            echo "âš  Warning: Missing Arabic language declaration"
          fi
          
          if ! grep -q 'dir="rtl"' index.html; then
            echo "âš  Warning: Missing RTL direction"
          fi
        fi
        
        # ÙØ­Øµ CSS files
        for css_file in css/*.css; do
          if [ -f "$css_file" ]; then
            echo "ÙØ­Øµ $css_file..."
            # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¯Ø¹Ù… RTL
            if grep -q "direction:" "$css_file" || grep -q "text-align:" "$css_file"; then
              echo "âœ… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù†Øµ"
            fi
          fi
        done
        
        # ÙØ­Øµ JavaScript files
        for js_file in js/*.js; do
          if [ -f "$js_file" ]; then
            echo "ÙØ­Øµ $js_file..."
            ARABIC_COMMENTS=$(grep -c '//.*[\x{0600}-\x{06FF}]' "$js_file" || true)
            echo "âœ… Ø¹Ø¯Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: $ARABIC_COMMENTS"
          fi
        done
        
        echo "âœ… ÙØ­Øµ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…ÙƒØªÙ…Ù„"
        
    - name: Generate language report
      run: |
        echo "# ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" > arabic-report.md
        echo "## Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ" >> arabic-report.md
        echo "- ðŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: $(date)" >> arabic-report.md
        echo "- ðŸ·ï¸ Ø§Ù„ÙØ±Ø¹: ${{ github.ref }}" >> arabic-report.md
        echo "" >> arabic-report.md
        
        # Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        if [ -f "index.html" ]; then
          echo "### index.html" >> arabic-report.md
          echo "- âœ… Ù…Ù„Ù HTML Ù…ÙˆØ¬ÙˆØ¯" >> arabic-report.md
          
          if grep -q 'lang="ar"' index.html; then
            echo "- âœ… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ lang=\"ar\"" >> arabic-report.md
          else
            echo "- âŒ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ lang=\"ar\"" >> arabic-report.md
          fi
          
          if grep -q 'dir="rtl"' index.html; then
            echo "- âœ… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ dir=\"rtl\"" >> arabic-report.md
          else
            echo "- âŒ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ dir=\"rtl\"" >> arabic-report.md
          fi
        fi
        
        echo "" >> arabic-report.md
        echo "### Ù…Ù„ÙØ§Øª CSS" >> arabic-report.md
        for css_file in css/*.css 2>/dev/null; do
          if [ -f "$css_file" ]; then
            echo "- ðŸ“„ $(basename "$css_file")" >> arabic-report.md
          fi
        done
        
        echo "" >> arabic-report.md
        echo "### Ù…Ù„ÙØ§Øª JavaScript" >> arabic-report.md
        for js_file in js/*.js 2>/dev/null; do
          if [ -f "$js_file" ]; then
            echo "- ðŸ“„ $(basename "$js_file")" >> arabic-report.md
          fi
        done
        
    - name: Upload language report
      uses: actions/upload-artifact@v4
      with:
        name: arabic-language-report
        path: arabic-report.md
